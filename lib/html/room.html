<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title><TMPL_VAR title> - ゆとチャadv.</title>
  <link rel="stylesheet" media="all" href="./lib/css/base.css?<TMPL_VAR ver>">
  <link rel="stylesheet" media="all" href="./lib/css/chat-common.css?<TMPL_VAR ver>">
  <link rel="stylesheet" media="all and (min-width: 601px)" href="./lib/css/chat-layout-pc.css?<TMPL_VAR ver>">
  <link rel="stylesheet" media="all and (max-width: 600px)" href="./lib/css/chat-layout-sp.css?<TMPL_VAR ver>">
  <link rel="stylesheet" media="all" href="./lib/css/config.css?<TMPL_VAR ver>">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/themes/classic.min.css"/>
  <TMPL_IF customCSS><link rel="stylesheet" media="all" href="<TMPL_VAR customCSS>"></TMPL_IF>
  <script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/pickr.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
  <script src="./lib/js/ui.js?<TMPL_VAR ver>" defer></script>
  <script src="./lib/js/ui-sp.js?<TMPL_VAR ver>" defer></script>
  <script src="./lib/js/chat.js?<TMPL_VAR ver>" defer></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <script>
    const roomId = '<TMPL_VAR roomId>';
    const tabArray = ['<TMPL_VAR tabArray>'];
    const setStatus = ['<TMPL_VAR sttNameList>'];
    const gameSystem = '<TMPL_VAR gameSystem>';
    const gameSystemName = '<TMPL_VAR gameSystemName>';
    const checkTimeMem =  2000; // 更新チェック周期（1000=1秒）
    const checkTimeRom = 10000; // 更新チェック周期・見学者
    let seType = {
      'chat' : './lib/sound/se-lab/cursor1.mp3',
      'mark' : './lib/sound/se-lab/warning1.mp3',
      'ready' : './lib/sound/se-lab/decision4.mp3',
    }
    const bcdiceAPI = '<TMPL_VAR bcdiceAPI>';
    let bcdiceSystem = '<TMPL_VAR bcdiceSystem>';
  </script>
</head>
<body>
  <div class="bg-image bg-front"></div>
  <div class="bg-image bg-back"></div>
  <div id="dark-back"></div>
  <div id="image-box" style="display:none"><img id="image-box-image"></div>
  <div id="base">
    <div class="box" id="sp-header">
      <div class="head-menu"><span id="menu-open" onclick="menuToggle();"></span></div>
      <h1><TMPL_VAR title></h1>
      <div class="head-mute"><span class="mute-button" onclick="muteToggle();"></span></div>
      <div class="head-side"><span id="side-open" onclick="sideToggle();"></span></div>
    </div>
    <div class="box" id="menubar">
    <ul>
      <li id="menu-button-logs"><a href="?mode=logs&id=<TMPL_VAR roomId>" target="_blank">ログ</a></li>
      <li id="menu-button-back"><a onclick="boxOpen('bg-set');">背景</a></li>
      <li id="menu-button-bgms"><a onclick="boxOpen('bgm-set');bgmPreviewEnd();">BGM</a></li>
      <li id="menu-button-user"><a onclick="boxOpen('config-user');">個人設定</a></li>
      <li id="menu-button-room"><a onclick="boxOpen('config-room');">ルーム設定</a></li>
      <li id="menu-button-help"><a onclick="boxOpen('help-window');">ヘルプ</a></li>
      <li id="menu-button-exit"><a onclick="boxOpen('exit-form');">退室</a></li>
    </ul>
    <ul>
      <li id="menu-mute-button"><a class="mute-button" onclick="muteToggle();"></a></li>
      <li>背景濃度 <span id="option-bg-opacity-view">100</span> %<input id="option-bg-opacity" type="range" min="0" max="100" step="1" value="100"></li>
      <li>背景不透過 <span id="option-box-opacity-view">70</span> %<input id="option-box-opacity" type="range" min="0.0" max="1.0" step="0.01" value="0.7"></li>
    </ul>
    </div>
    
    <!-- TOPIC -->
    <div class="box" id="topic">
      <div id="topic-value"></div>
      <span class="edit button" onclick="topicOpen()"></span>
    </div>
    <!-- / TOPIC -->
    
    <!-- CHAT-AREA -->
    <div id="chat-closes-area"></div>
    <div id="chat-area"></div>
    <!-- / CHAT-AREA -->
    
    <div class="box" id="tablist-area">
      <ul id="tablist"></ul>
    </div>
    <!-- FORM-AREA -->
    <div class="box" id="main-form">
      <div class="input-form">
        <div class="namelist-area">
          <span id="npc-del-button" class="button" onclick="npcDel()" title="一番下の名前を削除します">－</span>
          <span id="npc-edit-button" class="button" onclick="npcOpen()" title="名前一覧を一括編集します">編集</span>
          <span id="npc-add-button" class="button" onclick="npcAdd()" title="空の名前を追加します">＋</span>
          <select class="form-name bold" id="form-name" size="4" style="background:transparent;">
            <option value="0" selected></option>
          </select>
        </div>
        <div>
          <div class="comm-config-area">
            <div class="name-area">
              <input type="text" id="main-name1" class="main-name bold" style="background:transparent" title="現在の名前" placeholder="名前が空欄です" readonly>
              <span id="form-color-pickr" class="color-pickr" data-pickr="form-color"></span>
              <input type="text" id="form-color" class="" list="color-list" value="#FFFFFF" title="名前色">
            </div>
            <div class="address-area">
              <select id="form-address" title="発言送信先"><option value="">全員</option></select>
              <label for="secret-openlater" title="チェックを入れると、過去ログになった時には公開されます。"><input type="checkbox" id="secret-openlater"><b>後で公開</b></label>
            </div>
          </div>
          <div class="comm-area">
          <textarea class="form-comm autosize" id="form-comm-main" placeholder="Shift+Enterで改行"></textarea>
          <button onclick="formSubmit('form-comm-main');">送信</button>
          </div>
          <div class="decoration-buttons">
            <span class="button start insert-ruby"></span>
            <span class="button insert-em"></span>
            <span class="button insert-serif"></span>
            <span class="button insert-bold"      title="太字"></span>
            <span class="button insert-oblique"   title="斜体"></span>
            <span class="button insert-under"     title="下線"></span>
            <span class="button insert-strike"    title="打消線"></span>
            <span class="button insert-big"       title="大きい字"></span>
            <span class="button insert-small"     title="小さい字"></span>
            <span class="button insert-color"     title="色変え"></span>
            <span class="button insert-hide"      title="透明な字"></span>
            <span class="button insert-horizon"   title="水平線"></span>
            <span class="button insert-left"      title="左揃え"></span>
            <span class="button insert-center"    title="中央揃え"></span>
            <span class="button end insert-right" title="右揃え"></span>
            
            <span class="button start end insert-image" title="挿絵" onclick="boxOpen('image-insert');"></span>
          </div>
          
          <div class="check-buttons">
            <button onclick="unitCommandSubmit('check')">✔</button><button onclick="unitCommandSubmit('uncheck')">×</button>
          </div>
          <div class="form-dice" id="form-dice-0">
            <span class="del edit button" onclick="diceDel(0);" title="ダイス欄を削除">－</span>
            <span class="add edit button" onclick="diceAdd(0);" title="ダイス欄を追加">＋</span>
            <span class="shrink edit button" onclick="diceScale(0,'shrink');" title="ダイス欄を狭める">⇐</span>
            <span class="expand edit button" onclick="diceScale(0,'expand');" title="ダイス欄を拡げる">⇒</span>
          </div>
        </div>
        <div class="form-dice" id="form-dice-1">
          <span class="del edit button" onclick="diceDel(1);" title="ダイス欄を削除">－</span>
          <span class="add edit button" onclick="diceAdd(1);" title="ダイス欄を追加">＋</span>
          <span class="shrink edit button" onclick="diceScale(1,'shrink');" title="ダイス欄を狭める">⇐</span>
          <span class="expand edit button" onclick="diceScale(1,'expand');" title="ダイス欄を拡げる">⇒</span>
        </div>
      </div>
    </div>
    <!-- / FORM-AREA -->
    
    <!-- SIDE-AREA -->
    <div id="sidebar">
      <div class="button toggle" onclick="sidebarToggle()"></div>
      <div class="box" id="round">
        <div class="bold" id="round-value">0</div>
        <div class="round-buttons">
          <span class="button" onclick="roundSubmit('-1');" style="width:auto;font-size:88%;">戻る</span>
          <span class="button" onclick="roundSubmit('reset');" style="width:auto;font-size:88%;">0</span>
          <span class="button" onclick="roundSubmit('+1');" style="width:auto;font-size:88%;">次へ</span>
        </div>
      </div>
      <div class="box" id="status" data-num="0">
        <div id="status-body"></div>
        <span class="add button" onclick="sheetSelect('default');sheetOpen();">+</span>
        <span class="shrink edit button" onclick="statusScale('shrink');" title="狭める">⇐</span>
        <span class="expand edit button" onclick="statusScale('expand');" title="拡げる">⇒</span>
      </div>
      <div class="box memo" id="memo" data-num="0">
        <ul id="memo-list" class="bold"></ul>
        <span class="add button" onclick="memoSelect('')">+</span>
      </div>
    </div>
    <!-- / SIDE-AREA -->
    <!-- FOOTER -->
    <div class="box" id="footer">
      <dl>
        <dt>入室</dt><dd id="member-num" class="link" onclick="boxOpen('member-list')">－</dd>
        <dt>ルーム</dt><dd><TMPL_VAR title></dd>
        <dt>システム</dt><dd style="white-space: nowrap;"><TMPL_VAR gameSystemName></dd>
      </dl>
      <dl>
        <dt>背景</dt><dd id="bg-title">－</dd>
        <dt>BGM</dt><dd id="bgm-title">－</dd>
      </dl>
    </div>
    <!-- / FOOTER -->
    
    <!-- SHEET-->
    <div id="sheet-area">
    <div id="sheet-unit-default" class="box sheet">
      <h2>ユニット追加</h2>
      <div class="sheet-body-default">
        <dl>
          <dt>名前      </dt><dd><input id="new-unit-name-value"  type="text"></dd>
          <dt>名前色    </dt><dd><span class="color-pickr" data-pickr="new-unit-color-value"></span><input id="new-unit-color-value" type="text" class="selectcolor-unit" list="color-list" value="#ffffff"></dd>
          <dt>参照URL</dt><dd><input id="new-unit-url-value" type="url" placeholder="キャラシなどのURL"></dd>
          <dt>ステータス</dt><dd><textarea class="autosize" id="new-unit-stt-value"><TMPL_VAR newUnitSttDefault></textarea></dd>
        </dl>
        <ul>
          <li><label><input type="checkbox" id="new-unit-urlload"><b>URLからステータスを自動入力</b></label><br><span>（※ゆとシートⅡのみ）</span></li>
          <li><label><input type="checkbox" id="new-unit-addname"><b>名前欄にも追加する</b></label></li>
        </ul>
        <button onclick="newUnitSubmit();">作成</button>
      </div>
      <span class="close button" onclick="sheetClose();">×</span>
    </div>
    <div id="sheet-unit-memo" class="box sheet">
      <h2>共有メモ</h2>
      <div class="sheet-memo-body">
        <div class="sheet-memo-outline"><textarea id="sheet-memo-value" class="autosize"></textarea></div>
        <button onclick="memoSubmit();">追加／更新</button>
      </div>
      <span class="close button" onclick="sheetClose();">×</span>
    </div>
    <div id="close-area" class="box sheet" onclick="sheetOpen();"></div>
    </div>
    <!-- / SHEET-->
    
  </div><!-- / BASE -->
  
  <!-- FLOAT-BOXES -->
  <div class="float-box" id="image-insert">
    <h2>挿絵（画像挿入）</h2>
    <div>
      <div class="image-preview-area"><img id="image-insert-preview" style="max-width:100%;max-height:200px;"></div>
      <p>
        <input type="url" id="image-insert-url" oninput="imgPreview();" placeholder="http://..." data-comm-pre="/insert " style="width:100%">
      </p>
      <p class="center">
        <button onclick="formSubmit('image-insert-url');boxClose('image-insert');document.getElementById('image-insert-preview').src='';">送信</button>
      </p>
    </div>
    <span class="close button" onclick="boxClose('image-insert');">×</span>
  </div>
  
  <div class="float-box" id="edit-topic">
    <h2>トピック編集</h2>
    <div class="comm-area">
      <textarea class="bold autosize" id="edit-topic-value" data-comm-pre="/topic "></textarea>
      <button onclick="formSubmit('edit-topic-value');boxClose('edit-topic');">送信</button>
    </div>
    <span class="close button" onclick="boxClose('edit-topic');">×</span>
  </div>
  
  <div class="float-box" id="edit-npc">
    <h2>名前欄一括編集</h2>
    <div class="comm-area">
      <textarea class="autosize" id="edit-npc-value"></textarea>
      <button onclick="npcSave('edit-npc-value');boxClose('edit-npc');">決定</button>
    </div>
    ※改行で区切ります。<br>
    ※色は名前末尾に6桁のカラーコードで指定。<br>
    　省略すると、ランダムな色を割り当てます。<br>
    ※入室名は変更できません。<br>
    <span class="close button" onclick="boxClose('edit-npc');">×</span>
  </div>
  
  <div class="float-box" id="bg-set">
    <h2>背景画像変更</h2>
    <div>
      <div class="image-preview-area"><img id="bg-set-preview" style="max-width:100%;max-height:200px;"></div>
      <p>
        タイトル・権利表記等：<br>
        <input type="text" id="bg-set-title" placeholder="XXX／(c)YYY..."><br>
        ＵＲＬ：<br>
        <input type="text" id="bg-set-url" oninput="bgPreview();" placeholder="http://..."><br>
      <p class="center">
        <button onclick="bgSubmit();">変更する</button>
      </p>
    </div>
    <div>
      <h4><i class="far fa-images"></i>プリセット</h4>
      <ul class="bg-list" id="bg-preset"><TMPL_LOOP bgPreset>
        <li onclick="bgInputSet('<TMPL_VAR URL>', this.innerHTML)"><TMPL_VAR TITLE></li></TMPL_LOOP>
      </ul>
      <h4><i class="fas fa-history"></i>履歴</h4>
      <ul class="bg-list" id="bg-history"></ul>
      <TMPL_IF srcURL>
      <h4><i class="fas fa-check-circle"></i>使用可能URL</h4>
      <p>下記のドメインから始まるURL以外は使用できません。</p>
      <ul><TMPL_LOOP srcURL><li><TMPL_VAR URL></li></TMPL_LOOP></ul>
      </TMPL_IF>
      <h3><i class="fas fa-trash-alt"></i>背景画像削除</h3>
      <p>現在の背景を削除し、初期状態に戻します。</p>
      <p class="center">
        <button onclick="commSend('/bgreset',0,nameList[0]['name']);">削除する</button>
      </p>
    <span class="close button" onclick="boxClose('bg-set');">×</span>
    </div>
  </div>
  
  <div class="float-box" id="bgm-confirm" style="top:30vh;left:0;right:0;max-width:100%;">
    <h2>BGM再生確認</h2>
    <div id="bgm-youtube-area"><div id="bgm-yt-player"></div></div>
    <p style="padding:2em 0 1em;">
      BGMが設定されています<br>
      ［<span id="bgm-title-view"></span>］<br>
      （音量:<span id="bgm-volume-view"></span>％）
    </p>
    <p style="padding:0 0 2em;text-align:center;">
      <button onclick="bgmPlay();boxClose('bgm-confirm');" style="width:5.5em;">再生</button>
      <button onclick="bgmPause();boxClose('bgm-confirm');" style="width:5.5em;">停止</button>
    </p>
    <span class="close button" onclick="boxClose('bgm-confirm');">×</span>
  </div>
  <div class="float-box" id="bgm-set">
    <h2>BGM変更</h2>
    <div>
      <div id="bgm-set-preview-area">
        <audio id="bgm-set-preview" loop></audio>
        <div id="bgm-set-preview-time">
          <span id="bgm-set-preview-current">00:00</span> /
          <span id="bgm-set-preview-duration">00:00</span>
        </div>
        <span id="bgm-set-preview-play"></span>
        <div id="bgm-set-preview-seekbar"></div>
      </div>
      <div id="bgm-yt-preview-area" style="display:none"><div id="bgm-yt-preview"></div></div>
      <p>
        タイトル・権利表記等：<br>
        <input type="text" id="bgm-set-title" placeholder="XXX／(c)YYY..."><br>
        ＵＲＬ：<small>※オーディオファイル、またはYoutubeのURL</small><br>
        <input type="text" id="bgm-set-url" oninput="bgmPreview();" placeholder="http://..."><br>
        音量：(<span id="bgm-set-volume-text">100</span>%)<br>
        <input type="range" id="bgm-set-volume" oninput="bgmPreviewVol(this.value);" min="1" max="100" value="100" style="width: 80%;margin-left:10%">
      </p>
      <p class="center" style="margin-top:1em;">
        <button onclick="bgmSubmit();">変更する</button>
      </p>
    </div>
    <div>
      <h4><i class="far fa-images"></i>プリセット</h4>
      <ul class="bg-list" id="bgm-preset"><TMPL_LOOP bgmPreset>
        <li onclick="bgmInputSet('<TMPL_VAR URL>', this.innerHTML,<TMPL_VAR VOL>)" data-vol="<TMPL_VAR VOL>"><TMPL_VAR TITLE></li></TMPL_LOOP>
      </ul>
      <h4><i class="fas fa-history"></i>履歴</h4>
      <ul class="bg-list" id="bgm-history"></ul>
      <TMPL_IF srcURL>
      <h4><i class="fas fa-check-circle"></i>使用可能URL</h4>
      <p>下記のドメインから始まるURL以外は使用できません。</p>
      <ul><TMPL_LOOP srcURL><li><TMPL_VAR URL></li></TMPL_LOOP></ul>
      </TMPL_IF>
      <h3><i class="fas fa-trash-alt"></i>BGM削除</h3>
      <p>現在のBGMを削除し、無音状態に戻します。</p>
      <p class="center">
        <button onclick="commSend('/bgmreset',0,nameList[0]['name']);">削除する</button>
      </p>
    <span class="close button" onclick="boxClose('bgm-set');bgmPreviewEnd();">×</span>
    </div>
  </div>
  
  <div class="float-box" id="config-user">
    <h2>ユーザー個人設定</h2>
    <p>　ゲームルームを跨いで、あなただけに適用される設定です。</p>
    <details id="config-sound">
      <summary><i class="fas fa-volume-up"></i>サウンド設定</summary>
      <h4>■音量</h4>
      <table>
        <tr><th>マスターボリューム</th><td><input type="range" id="volume-master" data-type="master" min="0" max="100" step="1" value="80"></td><td id="volume-master-view">80%</td></tr>
        <tr><th>ＢＧＭ            </th><td><input type="range" id="volume-bgm"    data-type="bgm"    min="0" max="100" step="1" value="80"></td><td id="volume-bgm-view"   >80%</td></tr>
        <tr><th>チャット着信      </th><td><input type="range" id="volume-chat"   data-type="chat"   min="0" max="100" step="1" value="80"></td><td id="volume-chat-view"  >80%</td></tr>
        <tr><th>強調ワード着信    </th><td><input type="range" id="volume-mark"   data-type="mark"   min="0" max="100" step="1" value="80"></td><td id="volume-mark-view"  >80%</td></tr>
        <tr><th>レディチェック開始</th><td><input type="range" id="volume-ready"  data-type="ready"  min="0" max="100" step="1" value="80"></td><td id="volume-ready-view" >80%</td></tr>
      </table>
      <p>
        強調ワード音量・レディチェック音量は0にするとチャット着信音に統一されます。<br>
      </p>
      <h4>■着信SE</h4>
      <table>
        <tbody id="option-se-tabs"></tbody>
        <script>
          const chatTypeOptions = `<TMPL_LOOP chatSEList><option value="<TMPL_VAR URL>"><TMPL_VAR NAME></option></TMPL_LOOP>`;
        </script>
        <tbody>
          <tr>
            <th>強調ワード着信</th>
            <td><select id="option-se-mark" oninput="seTypeChange(this,'mark')">
              <TMPL_LOOP chatSEList><option value="<TMPL_VAR URL>"><TMPL_VAR NAME></option></TMPL_LOOP>
            </select></td></tr>
          <tr>
            <th>レディチェック開始</th>
            <td><select id="option-se-ready" oninput="seTypeChange(this,'ready')">
              <TMPL_LOOP readySEList><option value="<TMPL_VAR URL>"><TMPL_VAR NAME></option></TMPL_LOOP>
            </select></td>
          </tr>
        </tbody>
      </table>
    </details>
    <details>
      <summary><i class="fas fa-exclamation-circle"></i>通知設定</summary>
      <p>
        <input type="checkbox" id="mark-name-check" onchange="markNameToggle();">入室名を強調する<br>
        強調ワード：<br><textarea id="mark-list-value" class="autosize" rows="2" onchange="markListChange();"></textarea><br>
        　指定したワードが発言された際、強調表示します。<br>
        　改行で区切って複数設定することができます。<br>
      </p>
      <p>
        除外ワード：<br><textarea id="except-list-value" class="autosize" rows="2" onchange="exceptListChange();"></textarea><br>
        　強調ワードが発言されても、同発言に除外ワードが含まれる場合は強調されません。<br>
        　改行で区切って複数設定することができます。<br>
      </p>
    </details>
    <details>
      <summary><i class="fas fa-palette"></i>入力フォーム・チャットパレット設定</summary>
      <h3>■チャットパレット挙動</h3>
      <p>
        クリック時の転記先：
        <select id="option-palette-destinate">
          <option value="fall">パレット直下の発言欄
          <option value="main">メイン発言欄
        </select>
      </p>
      <h3>■サブ入力欄Enter・⏎ボタン挙動</h3>
      <table>
        <tr>
          <th><span class="fas fa-lock"></span></th>
          <td>
            <select id="option-subform-full-behavior">
              <option value="plain">そのまま送信
              <option value="copy" >メイン発言欄に転記
              <option value="add"  >メイン発言の入力も同時に送信
            </select>
          </td>
          <td>欄に全文残す</td>
        </tr>
        <tr>
          <th><span class="fas fa-dice-d6"></span></th>
          <td>
            <select id="option-subform-dice-behavior">
              <option value="plain">そのまま送信
              <option value="copy" >メイン発言欄に転記
              <option value="add"  >メイン発言の入力も同時に送信
            </select>
          </td>
          <td>欄にコマンドを残す</td>
        </tr>
        <tr>
          <th><span class="fas fa-user"></span></th>
          <td>
            <select id="option-subform-name-behavior">
              <option value="plain">そのまま送信
              <option value="copy" >メイン発言欄に転記
              <option value="add"  >メイン発言の入力も同時に送信
            </select>
          </td>
          <td>欄に発言名を残す</td>
        </tr>
        <tr>
          <th><span class="fas fa-comment"></span></th>
          <td>
            <select id="option-subform-off-behavior">
              <option value="plain">そのまま送信
              <option value="copy" >メイン発言欄に転記
              <option value="add"  >メイン発言の入力も同時に送信
            </select>
          </td>
          <td>欄を空にする</td>
        </tr>
        <tr>
          <th><span class="fas fa-sticky-note"></span></th>
          <td>送信しない</td>
          <td>メモ欄</td>
        </tr>
      </table>
      </p>
    </details>
    <details>
      <summary><i class="fas fa-font"></i>ログフォント設定</summary>
      <p>文字の明るさ　： <input id="option-font-lightness" type="range" min="50" max="100" step="1" value="100"> <span id="option-font-lightness-view">100</span>%</p>
      <div id="font-sample" class="logs-font">
        <TMPL_IF helpOnSW2>
        <span class="dash">――</span>『ソード・ワールド２．５』は、３本の剣が生み出した世界《ラクシア》を仲間と共に冒険するゲームだ。“冒険者”となり、自分たちだけの<ruby>物語<rt>セッション</rt></ruby>を体験しよう！
        <TMPL_ELSE>
        <TMPL_IF helpOnDX3>
          昨日と同じ今日。今日と同じ明日。世界は繰り返し時を刻み、変わらないように見えた。だが、世界はすでに変貌していた。<br>
          “ダブルクロス”<span class="dash">――</span>それは「裏切り」を意味する言葉。
        <TMPL_ELSE>
          あのイーハトーヴォのすきとおった風、夏でも底に冷たさをもつ青いそら、うつくしい森で飾られたモリーオ市、郊外のぎらぎらひかる草の波。
        </TMPL_IF>
        </TMPL_IF>
      </div>
      <p style="margin-top:0;">
        日本語フォント：
        <select id="option-font-family-jp">
        <TMPL_INCLUDE NAME="option-fonts.html">
        </select>
      </p>
      <div id="font-sample" class="logs-font serif">
        『ノームやノーム、足をとれ！　固めて縛って釘付けろ！』
      </div>
      <p style="margin-top:0;">
        明朝体フォント：
        <select id="option-font-family-min">
        <TMPL_INCLUDE NAME="option-fonts-min.html">
        </select>
      </p>
    </details>
    <details>
      <summary><i class="far fa-window-maximize"></i>ウィンドウ配置</summary>
      <p>
        ステータス・メモ一覧の配置：
        <select id="window-layout-sidebar" onchange="layoutChange()">
        <optgroup label="縦並び">
          <option value="right-top"   >→┃ 右側／↑上寄せ</option>
          <option value="right-bottom">→┃ 右側／↓下寄せ</option>
          <option value="left-top"    >┃← 左側／↑上寄せ</option>
          <option value="left-bottom" >┃← 左側／↓下寄せ</option>
        </optgroup>
        <optgroup label="横並び">
          <option value="high"   >━↑ 上段</option>
          <option value="shallow">━↓ 中下段（発言エリアの上）</option>
          <option value="deep"   >━↓ 最下段（発言エリアの下）</option>
        </optgroup>
        </select><br>
        キャラシート（リモコン・パレット操作エリア）の配置：
        <select id="window-layout-sheet" onchange="layoutChange()">
          <option value="R">→ 右端</option>
          <option value="L">← 左端</option>
        </select><br>
      </p>
    </details>
    <span class="close button" onclick="boxClose('config-user');">×</span>
  </div>
  
  <div class="float-box" id="config-room">
    <h2>ゲームルーム設定</h2>
    <p>
      　このゲームルームにのみ適用される設定です。<br>
      　変更すると、入室中の全ユーザーに変更が適用されます。<br>
    </p>
    <details>
      <summary><i class="fas fa-cogs"></i>基本設定</summary>
      <TMPL_IF userRoomFlag>
      <p>
        ゲームルーム名: <input type="text" id="config-room-name" value="<TMPL_VAR title>"><br>
        チャットタブ　: <input type="text" id="config-room-tab" value="<TMPL_VAR tabArrayValue>"><br>
        ステータス　　: <input type="text" id="config-room-status" value="<TMPL_VAR SttNameListValue>"><br>
        ゲームシステム: <select id="config-room-game" onchange="gameChange(this.value)">
          <option value="sw2">ソードワールド2.x</option>
          <option value="dx3">ダブルクロス3rd</option>
          <option value="">その他</option>
          <option value="bcdice">その他：BCDice-API使用</option>
        </select><br>
      </p>
      <p id="config-room-bcdice-options" style="padding-left: 1em; display: none;">
          <b>BCDice用オプション</b><br>
          APIのURL: <input type="url" id="config-room-bcdice-url" placeholder="https//..." onchange="BCDiceGet(this.value);" value="<TMPL_VAR bcdiceAPI>" style="width:20em;"><br>
          ダイスボット: <select id="config-room-bcdice-game"></select>
      </p>
      <form onsubmit="roomChange();return false;">
      <p>パスワード: <input type="password" id="config-room-password"></p>
      <p class="center"><button>変更</button></p>
      </form>
      <TMPL_ELSE>
      <p>
        ゲームルーム名: <TMPL_VAR title><br>
        チャットタブ　: <TMPL_VAR tabArrayValue><br>
        ステータス　　: <TMPL_VAR SttNameListValue><br>
        ゲームシステム: <TMPL_VAR gameSystemName><br>
      </p>
      <p>
        ※ユーザーは変更できないゲームルームです。
      </p>
      </TMPL_IF>
    </details>
    <details>
      <summary onclick="getFileName();"><i class="fas fa-file-export"></i>ログ初期化／保存／ルーム削除</summary>
      <form onsubmit="resetRoom();return false;">
      <p>
        このルームの現行ログを過去ログに格納（保存）し、初期化します。<br>
        <br>
        <b>パスワード</b>：<input type="password" id="room-reset-password"><br>
        <br>
        <label><input type="checkbox" id="room-reset-all" checked><b>最新ログ・トピック・ユニットも初期化する</b></label><br>
        （全員が強制退室になります）<br>
        <TMPL_IF userRoomFlag>
        <br>
        <label><input type="checkbox" id="room-delete"><b>ルームを削除する</b></label>
        <TMPL_ELSE><input type="hidden" id="room-delete">
        </TMPL_IF>
      </p>
        <details open>
          <summary>過去ログ設定</summary>
          <p>
            　保存される過去ログに関わる設定です。<br>
            　ログが空の場合は過去ログは保存されないため、入力の意味はありません。<br>
            <br>
            <b>ログファイル名</b>：<br>
            <input type="text" id="room-reset-filename" pattern="^[-0-9a-zA-Z_.]+$" title="使用できる文字は、半角英数字とハイフン、アンダーバー、ピリオドのみです。"> <a class="fas fa-sync-alt link" onclick="getFileName();">日付から設定</a><br>
            　過去ログ一覧に表示されます。<br>
            　空欄の場合、自動的に日付からファイル名をつけます。<br>
            <br>
            <b>ログタイトル</b>：<br>
            <input type="text" id="room-reset-logtitle"><br>
            　ログのタイトルバーと見出しに表示されます。<br>
            　空欄の場合、ゲームルーム名と同じになります。<br>
          </p>
          </details>
      <p class="center"><button>ログ初期化</button></p>
      </form>
    </details>
    <span class="close button" onclick="boxClose('config-room');">×</span>
  </div>
  </div>
  
  <div class="float-box" id="member-list">
    <h2>入室メンバー</h2>
    <p id="member-list-view"></p>
    <span class="close button" onclick="boxClose('member-list');">×</span>
  </div>
  
  <div class="float-box" id="ready-check">
    <h2>レディチェック（準備確認）</h2>
    <p class="center">
      <button onclick="readyCheckSubmit(1)">✔準備ＯＫ！</button>
      <button onclick="readyCheckSubmit(0)">×まだ待って</button>
    </p>
    <ul id="ready-list"></ul>
    <span class="close button" onclick="boxClose('ready-check');">×</span>
  </div>
  
  <div class="float-box" id="enter-form">
    <h2>ルーム：<TMPL_VAR title></h2>
    <p>
      名前<br>
      <input type="text" id="in-name"><br>
      <br>
      名前色<br>
      <span id="enter-color-area">
        <span class="color-pickr" data-pickr="in-color"></span><input type="text" id="in-color" class="selectcolor-in" list="color-list" value="#FFFFFF">
      </span><br>
      <br>
      <button onclick="enterRoom();">入室</button>
    </p>
    <p>
      <button onclick="enterRomRoom();">見学入室</button>
    </p>
    <div class="right">
      <a href="./?mode=logs&id=<TMPL_VAR roomId>"><i class="fas fa-align-left"></i>ログ</a>
      ／
      <a onclick="boxOpen('config-user');" href="#"><i class="fas fa-user-cog"></i>個人設定</a>
      ／
      <a onclick="boxOpen('config-room');" href="#"><i class="fas fa-cog"></i>ルーム設定</a>
      ／
      <a href="./"><i class="fas fa-undo-alt"></i>戻る</a>
    </div>
  </div>
  
  <div class="float-box" id="exit-form">
    このルームから退室しますか？<br>
    退室すると、以下の情報がリセットされます。<br>
    ［ダイス欄の入力値］<br>
    ［個人メモ］<br>
    <br>
    <button onclick="exitRoom();boxClose('exit-form');">退室</button>
    <div class="right" style="position:absolute;right:.5em;bottom:.5em;">
      <a href="./">退室せず部屋一覧へ移動</a>
    </div>
    <span class="close button" onclick="boxClose('exit-form');">×</span>
  </div>
  <div class="float-box" id="help-window">
    <h2>ヘルプ</h2>
    <div class="box-body">
      <TMPL_INCLUDE NAME="help.html">
    </div>
    <span class="close button" onclick="boxClose('help-window');">×</span>
  </div>
  
  <!-- / FLOAT-BOXES -->
  <!-- LIST -->
  
  <datalist id="color-list">
    <option value="#ffffff">white</option>
    <option value="#eeeeee">mercury</option>
    <option value="#cccccc">silver</option>
    <option value="#aaaaaa">moon stone</option>
    <option value="#888888">gray</option>
    <option value="#666666">gargoyle</option>
    <option value="#444444">hurricane</option>
    <option value="#222222">graphite</option>
    <option value="#000000">black</option>
    <option value="#56002b">emperors robe</option>
    <option value="#812b56">claret</option>
    <option value="#81002b">burgundy</option>
    <option value="#ab002b">fez</option>
    <option value="#ab0056">fuchsia</option>
    <option value="#ab2b56">crimson</option>
    <option value="#ab5681">aristoteles</option>
    <option value="#d581ab">cosmos</option>
    <option value="#d55681">azalee</option>
    <option value="#d52b56">carmine</option>
    <option value="#d52b81">rosario</option>
    <option value="#d5002b">dress to empress</option>
    <option value="#d50056">velvet</option>
    <option value="#ff002b">sevillan rot</option>
    <option value="#ff0056">christ rose</option>
    <option value="#ff0081">peonia</option>
    <option value="#ff2b56">cosmos pink</option>
    <option value="#ff2b81">bougainvillaea</option>
    <option value="#ff5681">rose</option>
    <option value="#ff56ab">hot pink</option>
    <option value="#ff81ab">happy bithday</option>
    <option value="#ffabd5">baby pink</option>
    <option value="#ffd5d5">powder pink</option>
    <option value="#ffabab">sardonyx</option>
    <option value="#ff8181">light coral</option>
    <option value="#ffab81">salmon pink</option>
    <option value="#ff5656">vermilion</option>
    <option value="#ff8156">sunset sky</option>
    <option value="#ff2b2b">scarlet</option>
    <option value="#ff562b">marigold</option>
    <option value="#ff812b">soleil</option>
    <option value="#ff0000">red</option>
    <option value="#ff2b00">ecarlate</option>
    <option value="#ff5600">valencia</option>
    <option value="#d50000">phoenix red</option>
    <option value="#d52b00">grenadier</option>
    <option value="#d55600">island sun</option>
    <option value="#d52b2b">coup de foudre</option>
    <option value="#d5562b">carrot</option>
    <option value="#d55656">royal rose</option>
    <option value="#d58156">raw sienna</option>
    <option value="#d58181">burnt sugar</option>
    <option value="#d5abab">mist mauve</option>
    <option value="#ab8181">rose gray</option>
    <option value="#ab5656">russet</option>
    <option value="#ab2b2b">fire brick</option>
    <option value="#ab562b">burnt sienna</option>
    <option value="#ab0000">volkan</option>
    <option value="#ab2b00">ox blood</option>
    <option value="#810000">garnet</option>
    <option value="#812b00">terra rosa</option>
    <option value="#812b2b">cardinal</option>
    <option value="#815656">heather</option>
    <option value="#562b2b">burnt umber</option>
    <option value="#560000">maroon</option>
    <option value="#2b0000">ivory black</option>
    <option value="#562b00">coffee</option>
    <option value="#81562b">raw umber</option>
    <option value="#815600">golden ochre</option>
    <option value="#ab8100">natural ochre</option>
    <option value="#ab5600">stil de grain yellow</option>
    <option value="#ab812b">hot toddy</option>
    <option value="#ab8156">cafe au lait</option>
    <option value="#d5ab81">honey sweet</option>
    <option value="#d5ab56">khaki</option>
    <option value="#d5ab2b">golden rod</option>
    <option value="#d5812b">calcutta curry</option>
    <option value="#d5ab00">ancient gold</option>
    <option value="#d58100">brown gold</option>
    <option value="#ffd500">gold</option>
    <option value="#ffab00">orange</option>
    <option value="#ff8100">flush orange</option>
    <option value="#ffd52b">auripigment</option>
    <option value="#ffab2b">sunlight yellow</option>
    <option value="#ffd556">mimosa</option>
    <option value="#ffab56">crescent gold</option>
    <option value="#ffd581">yellow buff</option>
    <option value="#ffd5ab">flesh</option>
    <option value="#ffffd5">edelweiss</option>
    <option value="#ffffab">light yellow</option>
    <option value="#ffff81">canary yellow</option>
    <option value="#d5ff81">honeysuckle</option>
    <option value="#ffff56">lemon yellow</option>
    <option value="#d5ff56">light citron</option>
    <option value="#ffff2b">sulphar yellow</option>
    <option value="#d5ff2b">lemon</option>
    <option value="#abff2b">green yellow</option>
    <option value="#ffff00">yellow</option>
    <option value="#d5ff00">flesh green</option>
    <option value="#abff00">campus green</option>
    <option value="#d5d500">renoncule</option>
    <option value="#abd500">chartreuse</option>
    <option value="#81d500">rainette</option>
    <option value="#d5d52b">dormant gold</option>
    <option value="#abd52b">acid green</option>
    <option value="#d5d556">sparkle green</option>
    <option value="#abd556">spring green</option>
    <option value="#d5d581">citrus yellow</option>
    <option value="#d5d5ab">mellow yellow</option>
    <option value="#abab81">citron gray</option>
    <option value="#abab56">dark khaki</option>
    <option value="#abab2b">olivine green</option>
    <option value="#81ab2b">pickles green</option>
    <option value="#abab00">jena</option>
    <option value="#81ab00">willow green</option>
    <option value="#818100">olive</option>
    <option value="#568100">mugwort</option>
    <option value="#81812b">terra</option>
    <option value="#818156">clay creek</option>
    <option value="#56562b">dark olive green</option>
    <option value="#565600">cranach</option>
    <option value="#2b2b00">taupe</option>
    <option value="#2b5600">avenue green</option>
    <option value="#56812b">leaf green</option>
    <option value="#2b8100">windsor green</option>
    <option value="#2bab00">apple green</option>
    <option value="#56ab00">vert libellule</option>
    <option value="#56ab2b">meadow green</option>
    <option value="#81ab56">grass green</option>
    <option value="#abd581">sprout</option>
    <option value="#81d556">vivid lime green</option>
    <option value="#56d52b">muscat green</option>
    <option value="#81d52b">linden green</option>
    <option value="#2bd500">lucky green</option>
    <option value="#56d500">rayon vert</option>
    <option value="#2bff00">green flash</option>
    <option value="#56ff00">lovebird</option>
    <option value="#81ff00">lawn green</option>
    <option value="#56ff2b">bright green</option>
    <option value="#81ff2b">gremlin green</option>
    <option value="#81ff56">isle of wight</option>
    <option value="#abff56">light lawn green</option>
    <option value="#abff81">lime light</option>
    <option value="#d5ffab">reef</option>
    <option value="#d5ffd5">ice green</option>
    <option value="#abffab">pale green</option>
    <option value="#81ff81">light paris green</option>
    <option value="#81ffab">aphrodite</option>
    <option value="#56ff56">peterpan</option>
    <option value="#56ff81">puritan green</option>
    <option value="#2bff2b">harlequin</option>
    <option value="#2bff56">azurite green</option>
    <option value="#2bff81">beryl green</option>
    <option value="#00ff00">lime</option>
    <option value="#00ff2b">signal green</option>
    <option value="#00ff56">canton green</option>
    <option value="#00d500">middle green</option>
    <option value="#00d52b">peridot</option>
    <option value="#00d556">vigorous green</option>
    <option value="#2bd52b">lime green</option>
    <option value="#2bd556">surf green</option>
    <option value="#56d556">beaumarchais</option>
    <option value="#56d581">descartes</option>
    <option value="#abd5ab">lush green</option>
    <option value="#81ab81">herbe</option>
    <option value="#56ab56">greenwich</option>
    <option value="#56ab81">celadon</option>
    <option value="#2bab2b">veronese green</option>
    <option value="#2bab56">spring note</option>
    <option value="#00ab00">medium green</option>
    <option value="#00ab2b">sunshine green</option>
    <option value="#008100">green</option>
    <option value="#00812b">chrome green</option>
    <option value="#2b812b">chive</option>
    <option value="#568156">foliage</option>
    <option value="#2b562b">terre verte</option>
    <option value="#005600">ever green</option>
    <option value="#002b00">dark green</option>
    <option value="#00562b">dragon</option>
    <option value="#2b8156">malachite green</option>
    <option value="#008156">viridian</option>
    <option value="#00ab81">oriental green</option>
    <option value="#00ab56">emerald green</option>
    <option value="#2bab81">beans green</option>
    <option value="#81d5ab">anglesey／winter green</option>
    <option value="#81d581">primavera</option>
    <option value="#56d5ab">coral green</option>
    <option value="#2bd5ab">blue zircon</option>
    <option value="#2bd581">aqua green</option>
    <option value="#00d5ab">opal green</option>
    <option value="#00d581">talisman green</option>
    <option value="#00ffd5">aqua</option>
    <option value="#00ffab">cleopatra</option>
    <option value="#00ff81">light turquoise</option>
    <option value="#2bffd5">mint blue</option>
    <option value="#2bffab">medici blue</option>
    <option value="#56ffd5">aquamarine</option>
    <option value="#56ffab">light spring green</option>
    <option value="#81ffd5">wateau</option>
    <option value="#abffd5">spring stream</option>
    <option value="#d5ffff">glacier blue／light cyan</option>
    <option value="#abffff">celeste</option>
    <option value="#81ffff">electric blue</option>
    <option value="#81d5ff">sky blue</option>
    <option value="#56ffff">thunderbird blue</option>
    <option value="#56d5ff">myosotis</option>
    <option value="#2bffff">italian blue</option>
    <option value="#2bd5ff">cornwall</option>
    <option value="#2babff">trade wind</option>
    <option value="#00ffff">cyan</option>
    <option value="#00d5ff">deep sky blue</option>
    <option value="#00abff">process cyan</option>
    <option value="#00d5d5">aqua mint</option>
    <option value="#00abd5">atlantic blue</option>
    <option value="#0081d5">cerulean blue</option>
    <option value="#2bd5d5">flesh blue</option>
    <option value="#2babd5">clear sky</option>
    <option value="#56d5d5">viking／sea serpent</option>
    <option value="#56abd5">comet blue</option>
    <option value="#81d5d5">arcardia</option>
    <option value="#abd5d5">fairy land</option>
    <option value="#81abab">venezia</option>
    <option value="#56abab">verona</option>
    <option value="#2babab">rouen</option>
    <option value="#2b81ab">delphia blue</option>
    <option value="#00abab">turquoise green</option>
    <option value="#0081ab">arabesque tag</option>
    <option value="#008181">dark cyan</option>
    <option value="#005681">triton</option>
    <option value="#2b8181">venit</option>
    <option value="#568181">vert de gris</option>
    <option value="#2b5656">dark slate gray</option>
    <option value="#005656">hyuaran</option>
    <option value="#002b2b">bottle green</option>
    <option value="#002b56">prussian blue</option>
    <option value="#2b5681">dark ocean</option>
    <option value="#002b81">luxor</option>
    <option value="#002bab">strato blue</option>
    <option value="#0056ab">cote d'azur</option>
    <option value="#2b56ab">cadiz blue</option>
    <option value="#5681ab">cadet blue</option>
    <option value="#81abd5">southern cross</option>
    <option value="#5681d5">academy blue</option>
    <option value="#2b56d5">azurite</option>
    <option value="#2b81d5">zenith blue</option>
    <option value="#002bd5">iliad blue</option>
    <option value="#0056d5">bleu acide</option>
    <option value="#002bff">goethe</option>
    <option value="#0056ff">regatta blue</option>
    <option value="#0081ff">symphony blue</option>
    <option value="#2b56ff">vermeer</option>
    <option value="#2b81ff">morning glory</option>
    <option value="#5681ff">cornflower blue</option>
    <option value="#56abff">forget me not</option>
    <option value="#81abff">lavender blue</option>
    <option value="#abd5ff">fresh air／light blue</option>
    <option value="#d5d5ff">alice blue</option>
    <option value="#ababff">hermes blue</option>
    <option value="#8181ff">menuetto</option>
    <option value="#ab81ff">tanzanite</option>
    <option value="#5656ff">hyacinth blue</option>
    <option value="#8156ff">hyacinth purple</option>
    <option value="#2b2bff">sapphire</option>
    <option value="#562bff">bermude</option>
    <option value="#812bff">bishop's violet</option>
    <option value="#0000ff">blue</option>
    <option value="#2b00ff">madinne blau</option>
    <option value="#5600ff">blue magenta</option>
    <option value="#0000d5">medium blue</option>
    <option value="#2b00d5">gentiane</option>
    <option value="#5600d5">electric violet</option>
    <option value="#2b2bd5">autumn azure</option>
    <option value="#562bd5">purple heart</option>
    <option value="#5656d5">smalt</option>
    <option value="#8156d5">blue violet</option>
    <option value="#8181d5">wistaria</option>
    <option value="#ababd5">day dream</option>
    <option value="#8181ab">echo blue</option>
    <option value="#5656ab">slate blue</option>
    <option value="#2b2bab">ultramarine</option>
    <option value="#562bab">daisy bush</option>
    <option value="#0000ab">lapis lazuli</option>
    <option value="#2b00ab">dark slate blue</option>
    <option value="#000081">dark blue</option>
    <option value="#2b0081">helio blue redish</option>
    <option value="#2b2b81">midnight blue</option>
    <option value="#565681">blue gray</option>
    <option value="#2b2b56">marine d'hiver</option>
    <option value="#000056">stratos</option>
    <option value="#00002b">sorcerer</option>
    <option value="#2b0056">purple navy</option>
    <option value="#562b81">violet</option>
    <option value="#560081">neptune</option>
    <option value="#5600ab">romanesque</option>
    <option value="#8100ab">iris purple</option>
    <option value="#812bab">amethyst</option>
    <option value="#8156ab">deluge</option>
    <option value="#ab81d5">lilac</option>
    <option value="#ab56d5">midium orchid</option>
    <option value="#812bd5">dark violet</option>
    <option value="#ab2bd5">erica</option>
    <option value="#8100d5">deep purple</option>
    <option value="#ab00d5">deep violet</option>
    <option value="#8100ff">vivid purple</option>
    <option value="#ab00ff">sindbad purple</option>
    <option value="#d500ff">vivid fuchsia</option>
    <option value="#ab2bff">purple magenta</option>
    <option value="#d52bff">spanish rose</option>
    <option value="#ab56ff">heliotrope</option>
    <option value="#d556ff">lampone</option>
    <option value="#d581ff">pastel cosmos</option>
    <option value="#d5abff">soft lavender</option>
    <option value="#ffd5ff">powder purple</option>
    <option value="#ffabff">light magenta</option>
    <option value="#ff81ff">mallow</option>
    <option value="#ff81d5">pastel pink</option>
    <option value="#ff56ff">pink flamingo</option>
    <option value="#ff56d5">radiant pink</option>
    <option value="#ff2bff">fiesta rose</option>
    <option value="#ff2bd5">razzle dazzle rose</option>
    <option value="#ff2bab">persian rose</option>
    <option value="#ff00ff">magenta</option>
    <option value="#ff00d5">carmen coral</option>
    <option value="#ff00ab">process magenta</option>
    <option value="#d500d5">renaissance</option>
    <option value="#d500ab">cherry pop</option>
    <option value="#d50081">ruby</option>
    <option value="#d52bd5">deep magenta</option>
    <option value="#d52bab">azalea pink</option>
    <option value="#d556d5">peony purple</option>
    <option value="#d556ab">chelsea rose</option>
    <option value="#d581d5">fairy pink</option>
    <option value="#d5abd5">old orchid</option>
    <option value="#ab81ab">aster hou</option>
    <option value="#ab56ab">orchid</option>
    <option value="#ab2bab">tyrian purple</option>
    <option value="#ab2b81">daphne</option>
    <option value="#ab00ab">dark magenta</option>
    <option value="#ab0081">dahlia purple</option>
    <option value="#810081">purple</option>
    <option value="#810056">mayfair rose</option>
    <option value="#812b81">royal purple</option>
    <option value="#815681">slate purple</option>
    <option value="#562b56">heath</option>
    <option value="#560056">charles de jem</option>
    <option value="#2b002b">misty purple</option>
  </datalist>
</body>
</html>